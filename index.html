<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DermAI | Skin Condition Analyzer</title>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family: "Segoe UI", Arial, sans-serif; }
    body { background:#f9fafb; color:#1f2937; line-height:1.6; }
    .navbar {
      background:white; padding:16px 60px; border-bottom:1px solid #e5e7eb;
      display:flex; justify-content:space-between; align-items:center;
    }
    .logo { font-size:24px; font-weight:700; color:#0d9488; }
    .navbar ul { display:flex; gap:32px; list-style:none; }
    .navbar a { color:#4b5563; text-decoration:none; font-weight:500; }
    .navbar a:hover { color:#0d9488; }

    .container { max-width:960px; margin:40px auto; padding:0 20px; }
    h1 { font-size:42px; text-align:center; margin-bottom:16px; color:#0d9488; }
    h2 { font-size:28px; margin:40px 0 20px; color:#111827; }
    p { font-size:17px; color:#4b5563; margin-bottom:16px; }

    form { background:white; padding:32px; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.06); }
    .form-group { margin-bottom:24px; }
    .form-group label { display:block; margin-bottom:8px; font-weight:500; color:#374151; }
    .form-group input, .form-group textarea {
      width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:16px;
    }
    .form-group textarea { min-height:100px; resize:vertical; }

    .symptoms-group { margin:32px 0; }
    #symptoms { width:100%; padding:12px; border:1px solid #d1d5db; border-radius:6px; font-size:16px; }

    #uploadArea {
      border:2px dashed #d1d5db; border-radius:12px; padding:60px; text-align:center;
      margin:40px auto; max-width:600px; cursor:pointer; transition:0.3s;
    }
    #uploadArea:hover { background:#f3f4f6; border-color:#0d9488; }
    #uploadArea p { font-size:18px; margin:16px 0 8px; }
    #uploadArea span { color:#6b7280; font-size:14px; }

    #submitBtn {
      display:block; width:200px; margin:32px auto 0;
      padding:14px; background:#0d9488; color:white; border:none; border-radius:8px;
      font-size:16px; font-weight:600; cursor:pointer;
    }
    #submitBtn:hover { background:#0b7a6f; }

    #result {
      margin-top:48px; background:#f9fafb; padding:32px; border-radius:12px;
      border:1px solid #d1d5db; display:none;
    }
    #result h3 { color:#0d9488; margin-bottom:24px; }
    #result p { margin-bottom:16px; font-size:17px; }

    footer { text-align:center; padding:40px 20px; color:#6b7280; font-size:14px; }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="logo">DermAI</div>
  <ul>
    <li><a href="#home">Home</a></li>
    <li><a href="#analyze">Analyze</a></li>
    <li><a href="about.html">About Model</a></li>
    <li><a href="disease.html">Skin disease</a></li>
  </ul>
</nav>

<div class="container">
  <h1>Skin Condition Analyzer</h1>

  <form id="analysisForm">
    <h2>Patient Information</h2>
    <div class="form-group">
      <label for="name">Full Name</label>
      <input type="text" id="name" required placeholder="Enter your full name">
    </div>
    <div class="form-group">
      <label for="age">Age</label>
      <input type="number" id="age" required min="1" max="120" placeholder="Enter your age">
    </div>
    <div class="form-group">
      <label for="email">Email Address</label>
      <input type="email" id="email" required placeholder="You will receive the report here">
    </div>
    <div class="form-group">
      <label for="phone">Phone Number (optional)</label>
      <input type="tel" id="phone" placeholder="Enter your phone number">
    </div>

    <h2>Symptoms</h2>
    <div class="form-group">
      <label for="symptoms">Describe your symptoms (comma separated or free text)</label>
      <textarea id="symptoms" rows="4" placeholder="Example: itching, redness, burning sensation, dry patches for 2 weeks"></textarea>
    </div>

    <h2>Skin Image</h2>
    <div id="uploadArea">
      <div style="font-size:48px; margin-bottom:16px;">⬆️</div>
      <p><strong>Upload a clear photo of the affected area</strong></p>
      <span>Click or drag & drop — JPG, PNG, WEBP</span>
      <input type="file" id="fileInput" hidden accept="image/*">
    </div>

    <button type="submit" id="submitBtn">Analyze & Send Report</button>
  </form>

  <div id="result">
    <h3>Analysis Report</h3>
    <p><strong>Predicted Condition:</strong> <span id="disease"></span></p>
    <p><strong>Confidence Level:</strong> <span id="confidence"></span></p>
    <p><strong>Symptom Alignment:</strong> <span id="match_score"></span></p>
    <p><strong>Matching Symptoms:</strong> <span id="matching"></span></p>
    <p><strong>Additional Notes:</strong> <span id="missing"></span></p>
    <p style="margin-top:24px; font-size:15px; color:#374151;">
      A detailed report has been sent to your email address.
    </p>
  </div>
</div>

<footer>
  <p>DermAI – Skin Condition Analyzer Prototype | For educational use only</p>
</footer>

<script>
  const form = document.getElementById("analysisForm");
  const uploadArea = document.getElementById("uploadArea");
  const fileInput = document.getElementById("fileInput");
  const resultBox = document.getElementById("result");

  let selectedFile = null;

  // Click to open file picker
  uploadArea.addEventListener("click", () => fileInput.click());

  // Handle file selection
  fileInput.addEventListener("change", () => {
    if (fileInput.files.length) {
      selectedFile = fileInput.files[0];
      uploadArea.style.borderColor = "#0d9488";
      uploadArea.style.background = "#f0fdfa";
    }
  });

  // Form submit handler
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    if (!selectedFile) {
      alert("Please upload a skin image.");
      return;
    }

    const formData = new FormData();
    formData.append("file", selectedFile);

    // Collect user info
    const userInfo = {
      name: document.getElementById("name").value.trim(),
      age: document.getElementById("age").value.trim(),
      email: document.getElementById("email").value.trim(),
      phone: document.getElementById("phone").value.trim(),
      symptoms: document.getElementById("symptoms").value.trim()
    };

    // Validate required fields
    if (!userInfo.name || !userInfo.age || !userInfo.email) {
      alert("Please fill in Name, Age, and Email.");
      return;
    }

    formData.append("user_info", JSON.stringify(userInfo));

    // Show loading
    document.getElementById("submitBtn").disabled = true;
    document.getElementById("submitBtn").textContent = "Analyzing & Sending...";

    try {
      const response = await fetch("http://127.0.0.1:5000/predict", {
        method: "POST",
        body: formData
      });

      const data = await response.json();

      if (data.error) throw new Error(data.error);

      document.getElementById("disease").innerText = data.disease;
      document.getElementById("confidence").innerText = data.confidence + "%";
      document.getElementById("match_score").innerText = data.match_score;
      document.getElementById("matching").innerText = data.matching.join(", ") || "None";
      document.getElementById("missing").innerText = data.missing.join(", ") || "None";

      resultBox.style.display = "block";
      alert("Analysis complete! Report sent to your email.");

    } catch (err) {
      alert("Error: " + err.message);
    } finally {
      document.getElementById("submitBtn").disabled = false;
      document.getElementById("submitBtn").textContent = "Analyze & Send Report";
    }
  });
</script>

</body>
</html>
